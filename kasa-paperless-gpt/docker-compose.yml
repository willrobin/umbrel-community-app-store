version: "3.7"

services:
  app_proxy:
    environment:
      # Format: <app-id>_<docker-service-name>_1
      APP_HOST: kasa-paperless-gpt_server_1
      APP_PORT: 8080

  server:
    image: icereed/paperless-gpt:latest
    init: true
    restart: unless-stopped
    environment:
      # Set this to your Paperless-ngx URL (Umbrel typically uses port 2349).
      PAPERLESS_BASE_URL: "http://umbrel.local:2349"
      PAPERLESS_API_TOKEN: "CHANGE_ME"
      MANUAL_TAG: "paperless-gpt"
      AUTO_TAG: "paperless-gpt-auto"
      LLM_PROVIDER: "ollama"
      LLM_MODEL: "qwen2.5:7b"
      OLLAMA_HOST: "http://<ollama-host>:11434"
      TOKEN_LIMIT: "4096"
    volumes:
      - ${APP_DATA_DIR}/paperless-gpt/prompts:/app/prompts
      - ${APP_DATA_DIR}/paperless-gpt/db:/app/db
